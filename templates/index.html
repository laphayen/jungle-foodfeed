<!DOCTYPE html>
<html>

<head>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
        crossorigin="anonymous"></script>
    <!-- 카카오맵 api-->
    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=eb7111e6861b9a4cfde6eb263dbb5ff7&libraries=services,clusterer,drawing"></script>

    <meta charset="utf-8" />
    <title>Jungle foodfeed</title>
    <style>
        div.left {
            width: 300px;
            float: left;
            background-color: rgba(141, 141, 141, 0.64);
            z-index: 3;
        }
        #map {
            width: 100vw;
            height: 100vw;
            scale: 1.09;
            z-index: 0;
        }

        .right{
            z-index: 0;
        }
        .search {
            position: relative;
            width: 300px;
        }
        /* 모달 */
        .modal {
            display: none;
        }
        /* 피드 */
        .card {
            margin: 10px;
        }

        .wrap{
            display: flex;
            flex-direction: row;
        }
    </style>
</head>

<body>
    <!-- 사이드바 -->
    <div class="wrap">
        <div class="left">
            <div>
                <h1 style="margin-left: 10px;">Jungle-foodfeed</h1>
            </div>
            <!-- 검색창 -->
            <div class="input-group mb-3" style="margin: 10px; width: 18rem;">
                <input type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2">
                <button class="btn btn-outline-secondary" type="button" id="button-addon2">Button</button>
            </div>
            <!-- 피드 -->
            <div class="card" style="width: 18rem;">
                <div class="card-body">
                    <h5 class="card-title">상호명</h5>
                    <p class="card-text">추가 정보</p>
                    <div style="display: inline-block;">
                        <a href="#" class="btn btn-primary">
                            좋아요
                            <img src="/static/heart_img.png" style="width: 25px; height: 25px;">
                        </a>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="right">
            <div>
                <!-- 지도 크기 지정-->
                <div id="map"></div>
                <!-- api키를 가져온다-->
                <script>
                    var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
                        mapOption = {
                            center: new kakao.maps.LatLng(36.392110, 127.404816), // 지도의 중심좌표
                            level: 3 // 지도의 확대 레벨
                        };
    
                    // 지도를 옵션으로 생성한다. 
                    var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
    
                    // 지도를 클릭했을때 클릭한 위치에 마커를 추가하도록 지도에 클릭이벤트를 등록합니다
                    kakao.maps.event.addListener(map, 'click', function (mouseEvent) {
                        // 클릭한 위치에 마커를 표시합니다 
                        addMarker(mouseEvent.latLng);
                        console.log(1)
                        //모달창 
                        const myModal = $('.modal')
                        myModal.css('display', 'block')
                    });
    
                    function closeModal() {
                        const myModal = $('.modal')
                        myModal.css('display', 'none')
                    }
    
                    // 지도에 표시된 마커 객체를 가지고 있을 배열입니다
                    var markers = [];
    
                    // 마커 하나를 지도위에 표시합니다 
                    addMarker(new kakao.maps.LatLng(33.450701, 126.570667));
    
                    // 마커를 생성하고 지도위에 표시하는 함수입니다
                    function addMarker(position) {
    
                        // 마커를 생성합니다
                        var marker = new kakao.maps.Marker({
                            position: position
                        });
    
                        // 마커가 지도 위에 표시되도록 설정합니다
                        marker.setMap(map);
    
                        // 생성된 마커를 배열에 추가합니다
                        markers.push(marker);
    
                    }
    
                    // 배열에 추가된 마커들을 지도에 표시하거나 삭제하는 함수입니다
                    function setMarkers(map) {
                        for (var i = 0; i < markers.length; i++) {
                            markers[i].setMap(map);
                        }
                    }
    
                    // "마커 보이기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에 표시하는 함수입니다
                    function showMarkers() {
                        setMarkers(map)
                    }
    
                    // "마커 감추기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에서 삭제하는 함수입니다
                    function hideMarkers() {
                        setMarkers(null);
                    }
    
                </script>
            </div>
        </div>
    </div>
    <!-- 지도 화면 -->

     <!--모달 창-->
     <div class="modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Modal body text goes here.</p>
                </div>
                <div class="modal-footer">
                    <button onclick="closeModal()" type="button" class="btn btn-secondary"
                        data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 지도 화면 -->
    <div class="right">
        <div>
            <!-- 지도 크기 지정-->
            <div id="map"></div>
            <!-- api키를 가져온다-->
            <script>
                var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
                    mapOption = {
                        center: new kakao.maps.LatLng(36.392110, 127.404816), // 지도의 중심좌표
                        level: 4 // 지도의 확대 레벨
                    };

                // 지도를 옵션으로 생성한다. 
                var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
                var sw = new kakao.maps.LatLng(36.404878, 127.412622), ne = new kakao.maps.LatLng(36.3899, 127.392);
                // 검색된 장소 위치를 기준으로 지도 범위를 재설정하기위해
                // LatLngBounds 객체에 좌표를 추가합니다
                var bounds = new kakao.maps.LatLngBounds(sw, ne);
                map.setBounds(bounds);

                // 지도를 클릭했을때 클릭한 위치에 마커를 추가하도록 지도에 클릭이벤트를 등록합니다
                kakao.maps.event.addListener(map, 'click', function (mouseEvent) {
                    // 클릭한 위치에 마커를 표시합니다 
                    addMarker(mouseEvent.latLng);
                    console.log(1)
                    //모달창 
                    const myModal = $('.modal')
                    myModal.css('display', 'block')
                });

                function closeModal() {
                    const myModal = $('.modal')
                    myModal.css('display', 'none')
       }
                // 장소 검색 객체를 생성합니다
                var ps = new kakao.maps.services.Places();
                ps.setMap(map);

                function search() {
                    // 키워드로 장소를 검색합니다
                    ps.keywordSearch('대전 유성구 전민동'+$('#testid').val(), placesSearchCB,useMapBounds=true);
                    ps.keywordSearch('대전 유성구 문지동'+$('#testid').val(), placesSearchCB,useMapBounds=true);
                }
//
                // 키워드 검색 완료 시 호출되는 콜백함수 입니다
                function placesSearchCB(data, status, pagination) {
                    if (status === kakao.maps.services.Status.OK) {
                        if (status === kakao.maps.services.Status.OK) {
                            // 데이터 확인
                            console.log(data);
                        } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
                            alert('검색 결과가 존재하지 않습니다.');
                            return;
                        } else if (status === kakao.maps.services.Status.ERROR) {
                            alert('검색 결과 중 오류가 발생했습니다.');
                            return;
                        }

                        for (var i = 0; i < data.length; i++) {
                            displayMarker(data[i]);
                        }

                        // 검색된 장소 위치를 기준으로 지도 범위를 재설정합니다
                        map.setBounds(bounds);
                    }
                }

                // 지도에 표시된 마커 객체를 가지고 있을 배열입니다
                var markers = [];

                // 마커 하나를 지도위에 표시합니다 
                addMarker(new kakao.maps.LatLng(33.450701, 126.570667));

                // 마커를 생성하고 지도위에 표시하는 함수입니다
                function addMarker(position) {

                    // 마커를 생성합니다
                    var marker = new kakao.maps.Marker({
                        position: position
                    });

                    // 마커가 지도 위에 표시되도록 설정합니다
                    marker.setMap(map);

                    // 생성된 마커를 배열에 추가합니다
                    markers.push(marker);

                }

                // 배열에 추가된 마커들을 지도에 표시하거나 삭제하는 함수입니다
                function setMarkers(map) {
                    for (var i = 0; i < markers.length; i++) {
                        markers[i].setMap(map);
                    }
                }

                // "마커 보이기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에 표시하는 함수입니다
                function showMarkers() {
                    setMarkers(map)
                }

                // "마커 감추기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에서 삭제하는 함수입니다
                function hideMarkers() {
                    setMarkers(null);
                }

            </script>
        </div>
    </div>
</body>

</html>